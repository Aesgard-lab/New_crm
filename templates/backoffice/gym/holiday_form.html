{% extends "backoffice/base.html" %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-b from-slate-50 to-slate-100 py-8 px-4">
    <div class="max-w-4xl mx-auto">
        
        <!-- Header -->
        <div class="flex items-center gap-4 mb-8">
            <a href="{% url 'gym_holidays_list' %}" class="text-slate-600 hover:text-slate-900 text-2xl transition-colors">
                ‚Üê Volver
            </a>
            <div>
                <h1 class="text-3xl font-bold text-slate-900">{{ title }}</h1>
                <p class="text-slate-600 mt-1">Configura un d√≠a festivo para el gym</p>
            </div>
        </div>

        <!-- Formulario -->
        <form method="POST" class="bg-white rounded-2xl shadow-lg p-8">
            {% csrf_token %}
            
            <div class="space-y-6">
                
                <!-- Fecha -->
                <div>
                    <label for="{{ form.date.id_for_label }}" class="block text-sm font-semibold text-slate-900 mb-2">
                        üìÖ {{ form.date.label }}
                    </label>
                    {{ form.date }}
                    {% if form.date.errors %}
                        <p class="text-red-600 text-sm mt-1">{{ form.date.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Nombre -->
                <div>
                    <label for="{{ form.name.id_for_label }}" class="block text-sm font-semibold text-slate-900 mb-2">
                        üéÑ {{ form.name.label }}
                    </label>
                    {{ form.name }}
                    {% if form.name.errors %}
                        <p class="text-red-600 text-sm mt-1">{{ form.name.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Separador -->
                <div class="border-t-2 border-slate-200 pt-6">
                    <h3 class="text-lg font-semibold text-slate-900 mb-4">Estado del Gym</h3>
                    
                    <!-- ¬øGym Cerrado? -->
                    <div class="flex items-center p-4 bg-slate-50 rounded-lg mb-4">
                        <div class="flex-1">
                            <label for="{{ form.is_closed.id_for_label }}" class="flex items-center cursor-pointer">
                                {{ form.is_closed }}
                                <span class="ml-3 font-medium text-slate-900">{{ form.is_closed.label }}</span>
                            </label>
                            <p class="text-sm text-slate-600 mt-1 ml-8">Si no est√° marcado, el gym abre con horario normal</p>
                        </div>
                    </div>

                    <!-- Horario Especial (mostrar si est√° cerrado) -->
                    <div id="special-hours-section" class="space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200" style="display: none;">
                        <p class="text-sm text-blue-900">Configure horarios especiales si el gym abre en horario especial</p>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="{{ form.special_open.id_for_label }}" class="block text-sm font-medium text-slate-900 mb-2">
                                    {{ form.special_open.label }}
                                </label>
                                {{ form.special_open }}
                            </div>
                            <div>
                                <label for="{{ form.special_close.id_for_label }}" class="block text-sm font-medium text-slate-900 mb-2">
                                    {{ form.special_close.label }}
                                </label>
                                {{ form.special_close }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Separador -->
                <div class="border-t-2 border-slate-200 pt-6">
                    <h3 class="text-lg font-semibold text-slate-900 mb-4">Excepciones y Permisos</h3>
                    
                    <!-- Permitir Clases Forzadas -->
                    <div class="flex items-start p-4 bg-slate-50 rounded-lg">
                        <div class="flex-1">
                            <label for="{{ form.allow_classes.id_for_label }}" class="flex items-center cursor-pointer">
                                {{ form.allow_classes }}
                                <span class="ml-3 font-medium text-slate-900">{{ form.allow_classes.label }}</span>
                            </label>
                            <p class="text-sm text-slate-600 mt-2 ml-8">
                                Habilita esta opci√≥n si permites que los instructores programen clases especiales en este d√≠a festivo
                            </p>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Botones de Acci√≥n -->
            <div class="flex items-center gap-4 mt-8 pt-6 border-t border-slate-200">
                <button type="submit" class="btn btn-primary px-8">
                    üíæ Guardar
                </button>
                <a href="{% url 'gym_holidays_list' %}" class="btn btn-secondary px-8">
                    ‚úï Cancelar
                </a>
            </div>
        </form>

        <!-- Ejemplos -->
        <div class="mt-8 bg-amber-50 border-l-4 border-amber-500 rounded-lg p-6">
            <h3 class="font-semibold text-amber-900 mb-3">üìù Ejemplos de Uso</h3>
            <div class="space-y-3 text-sm text-amber-900">
                <p>
                    <strong>Navidad - Gym Cerrado:</strong><br>
                    Fecha: 25/12 | Nombre: Navidad | Cerrado: ‚úì | Clases Forzadas: ‚úó
                </p>
                <p>
                    <strong>A√±o Nuevo - Con Clases Especiales:</strong><br>
                    Fecha: 01/01 | Nombre: A√±o Nuevo | Cerrado: ‚úì | Clases Forzadas: ‚úì
                </p>
                <p>
                    <strong>D√≠a Especial - Horario Reducido:</strong><br>
                    Fecha: 15/08 | Nombre: Asunci√≥n | Cerrado: ‚úó | Horario: 10:00-18:00
                </p>
            </div>
        </div>

    </div>
</div>

<script>
    // Mostrar/ocultar secci√≥n de horarios especiales
    document.getElementById('{{ form.is_closed.id_for_label }}').parentElement.addEventListener('change', function(e) {
        const section = document.getElementById('special-hours-section');
        section.style.display = e.target.checked ? 'block' : 'none';
    });

    // Inicializar estado al cargar
    window.addEventListener('load', function() {
        const isClosedInput = document.querySelector('[name="{{ form.is_closed.name }}"]');
        if (isClosedInput && isClosedInput.checked) {
            document.getElementById('special-hours-section').style.display = 'block';
        }
    });
</script>
{% endblock %}
